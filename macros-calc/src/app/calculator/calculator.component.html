<app-header></app-header>
<div class="container">
    <form (ngSubmit)="onSubmit()" [formGroup]="foodForm">
        <div class="row">
            <h2>Usados antes</h2>
            <table mat-table [dataSource]="dataSource!">
                <ng-container matColumnDef="nombre">
                    <th mat-header-cell *matHeaderCellDef> Nombre
                        <div class="input-group input-group-sm mb-3">
                            <input type="text" class="form-control form-control-sm" formControlName="buscador"
                                [(ngModel)]="searchByName" placeholder="Buscar por nombre" (input)="search($event)">
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary btn-sm" type="button" (click)="search($event)">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                    </th>
                    <td mat-cell *matCellDef="let element"> {{element.nombre}} </td>
                </ng-container>

                <ng-container matColumnDef="cantidad">
                    <th mat-header-cell *matHeaderCellDef> Cantidad </th>
                    <td mat-cell *matCellDef="let element"> {{element.cantidad +" "+element.unidad}} </td>
                </ng-container>

                <ng-container matColumnDef="grasa">
                    <th mat-header-cell *matHeaderCellDef> Grasa </th>
                    <td mat-cell *matCellDef="let element"> {{element.grasa}} </td>
                </ng-container>

                <ng-container matColumnDef="carbohidrato">
                    <th mat-header-cell *matHeaderCellDef> Carbohidrato </th>
                    <td mat-cell *matCellDef="let element"> {{element.carbohidrato}} </td>
                </ng-container>

                <ng-container matColumnDef="proteina">
                    <th mat-header-cell *matHeaderCellDef> Proteína </th>
                    <td mat-cell *matCellDef="let element"> {{element.proteina}} </td>
                </ng-container>

                <ng-container matColumnDef="marca">
                    <th mat-header-cell *matHeaderCellDef> Marca </th>
                    <td mat-cell *matCellDef="let element"> {{element.marca}} </td>
                </ng-container>

                <ng-container matColumnDef="seleccionar">
                    <th mat-header-cell *matHeaderCellDef> </th>
                    <td mat-cell *matCellDef="let element">
                        <button type="button" class="btn btn-light" (click)="seleccionar(element)">
                            <i class="bi bi-{{foodBase.id==element.id?'check-circle-fill':'circle'}}"></i>
                        </button>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                <tr mat-row *matRowDef="let myRowData; columns: columnsToDisplay">

                </tr>
            </table>
            <mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Página">
            </mat-paginator>
        </div>
        <div class="row">
            <h2>Alimento base
                <div class="btn-group" role="group" aria-label="Basic example">
                    <button type="button" class="btn btn-secondary" (click)="activarFormNuevo();"><i class="bi bi-{{nuevo?'x-circle':'plus-circle-dotted'}}"></i></button>
                    <button type="button" class="btn btn-secondary" [disabled]="!nuevo" (click)="guardar()"><i class="bi bi-floppy"></i></button>
                </div>
            </h2>
            <div class="col-6">
                <div class="form-group">
                    <label for="formInputNombre">Nombre</label>
                    <input type="text" class="form-control" id="formInputNombre" placeholder="Nombre"
                        formControlName="nombre" [ngClass]="{'is-invalid': form['nombre'].errors }"
                        [(ngModel)]="foodBase.nombre">
                </div>
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label for="formInputNombre">Marca</label>
                    <input type="text" class="form-control" id="formInputMarca" placeholder="Marca"
                        formControlName="marca" [ngClass]="{'is-invalid': form['marca'].errors }"
                        [(ngModel)]="foodBase.marca">
                </div>
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label for="formInputBase">Cantidad Base</label>
                    <input type="number" class="form-control" id="formInputBase" placeholder="Cantidad Base"
                        formControlName="base" [ngClass]="{'is-invalid': form['base'].errors }"
                        [(ngModel)]="foodBase.cantidad">
                </div>
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label for="formInputBase">Unidad</label>
                    <input type="text" class="form-control" id="formInputBase" placeholder="Unidad"
                        formControlName="unidad" [ngClass]="{'is-invalid': form['base'].errors }"
                        [(ngModel)]="foodBase.unidad">
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="formInputGrasa">Grasas</label>
                    <input type="number" class="form-control" id="formInputGrasa" placeholder="G"
                        formControlName="grasa" [ngClass]="{'is-invalid': form['grasa'].errors }"
                        [(ngModel)]="foodBase.grasa">
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="formInputCarbo">Carbohidratros</label>
                    <input type="number" class="form-control" id="formInputCarbo" placeholder="C"
                        formControlName="carbo" [ngClass]="{'is-invalid': form['carbo'].errors }"
                        [(ngModel)]="foodBase.carbohidrato">
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="formInputProt">Proteínas</label>
                    <input type="number" class="form-control" id="formInputProt" placeholder="P"
                        formControlName="proteina" [ngClass]="{'is-invalid': form['proteina'].errors }"
                        [(ngModel)]="foodBase.proteina">
                </div>
            </div>
        </div>
        <div class="row">
            <h2>Cálculado</h2>
            <div class="col-12">
                <label for="formInputBase">Cantidad a calcular ({{foodBase.unidad}})</label>
                <div class="input-group mb-3">
                    <input type="number" class="form-control" id="formInputBase" placeholder="Cantidad a calcular"
                        formControlName="cantidad" [ngClass]="{'is-invalid': form['cantidad'].errors }"
                        [(ngModel)]="foodCalculated.cantidad">
                    <button class="btn btn-info" type="submit" id="button-addon2" [disabled]="nuevo"><i class="bi bi-calculator"></i> Calcular</button>
                </div>
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label for="formInputCalcNombre">Nombre</label>
                    <input type="text" class="form-control" id="formInputCalcNombre" placeholder="Nombre"
                        formControlName="calcNombre" [(ngModel)]="foodCalculated.nombre">
                </div>
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label for="formInputCalcMarca">Marca</label>
                    <input type="text" class="form-control" id="formInputCalcMarca" placeholder="Marca"
                        formControlName="calcMarca" [(ngModel)]="foodCalculated.marca">
                </div>
            </div>
            <div class="col-4">
                <div class="form-group">
                    <label for="formInputCalcGrasa">Grasas</label>
                    <label type="text" class="form-control" id="formInputCalcGrasa"
                        placeholder="G">{{foodCalculated.grasa | number }}</label>
                </div>
            </div>
            <div class="col-4">
                <div class="form-group">
                    <label for="formInputCalcCarbo">Carbohidratros</label>
                    <label type="text" class="form-control" id="formInputCalcCarbo"
                        placeholder="C">{{foodCalculated.carbohidrato | number }}</label>
                </div>
            </div>
            <div class="col-4">
                <div class="form-group">
                    <label for="formInputCalcProt">Proteínas</label>
                    <label type="text" class="form-control" id="formInputCalcProt"
                        placeholder="P">{{foodCalculated.proteina | number }}</label>
                </div>
            </div>
        </div>
        <div class="row" style="display: none;">
            <h2>Agregados</h2>
        </div>
    </form>
</div>
<app-footer></app-footer>